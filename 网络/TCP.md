#TCP

1. 为什么需要三次握手
    - 需要双方都确认对方的序列号，才能保证这一次连接是可靠的。
    - 为了防止已失效的连接报文段又传到了服务端，导致出现服务端一直等待，客户端又不发送数据，浪费服务端资源。
    
2. 四次挥手中的 TIME-WAIT 作用
    - 保证自己最后一次发送的 ACK 能到达对方，如果因为网络原因，对方没收到 ACK，对方会重发 FIN 报文段，2MSL 期间，就能收到对方重发的 FIN 报文段了，
    自己就能再次发送 ACK 确认报文（会重置 2MSL），保证 TCP 连接准确关闭。
    - 能让已失效的请求连接在 2MSL 间从网络中消失（如果没有这一个等待，失效的报文段可能还存活在网络中），保证下一次 TCP 连接时，不会有旧的报文段出现。 

3. TCP 能不能强制关闭连接
   - 可以，TCP 报文中标志位有 RST，发送RST时，主动关闭方认为这个连接有问题，就能发送RST报文，不管被动方的ACK，即可关闭连接。

4. FIN WAIT2 状态是否可以直接关闭连接
   - 可以，FIN WAIT2状态下，TCP 协议栈会开启一个定时器，超过一定时间（10分钟）后没有收到服务端的FIN，就会进入close。
   
![三次握手.png](..%2Fimg%2F%E4%B8%89%E6%AC%A1%E6%8F%A1%E6%89%8B.png)
![四次挥手.png](..%2Fimg%2F%E5%9B%9B%E6%AC%A1%E6%8C%A5%E6%89%8B.png)